define("tiny_codepro/ui",["exports","./modal","core/modal_factory","core/modal_events","./common"],(function(_exports,_modal,_modal_factory,_modal_events,_common){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Tiny CodePro plugin.
   *
   * @module      tiny_codepro/plugin
   * @copyright   2023 Josep Mulet Pol <pmulet@iedib.net>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.handleAction=void 0,_modal=_interopRequireDefault(_modal),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events);_exports.handleAction=editor=>{displayDialogue(editor)};const displayDialogue=async editor=>{const data={elementid:"codepro_"+editor.id},modal=await _modal_factory.default.create({type:_modal.default.TYPE,templateContext:data,large:!0});console.log("The root of modal",modal,modal.getRoot()),modal.getRoot().find("div.modal-dialog").css({maxWidth:"100%",margin:0}),modal.header.hide(),modal.footer.show();const monaco=await lazyLoadMonaco();console.log("creant l'editor ara");const vseditor=monaco.editor.create(modal.body.find("#codepro_"+editor.id)[0],{value:editor.getContent(),language:"html",automaticLayout:!0,theme:"vs-light"});modal.onresize=function(){vseditor.layout()},modal.footer.find("button.btn").on("click",(evt=>{if(evt.target.classList.contains("btn-primary")){const newContent=vseditor.getValue();console.log(newContent),editor.setContent(newContent,{format:"html"})}modal.hide(),vseditor.dispose(),modal.destroy()})),modal.getRoot().on(_modal_events.default.hidden,(()=>{vseditor.dispose(),modal.destroy()})),modal.show()},lazyLoadMonaco=function(){return new Promise((resolve=>{window.monaco&&window.MonacoEditorEx?resolve(window.monaco):(require.config({paths:{vs:_common.baseUrl+"/amd/assets/monaco-editor/min/vs",tiny_codepro_vsex:_common.baseUrl+"/amd/assets/monaco-editor-ex"}}),require(["tiny_codepro_vsex","vs/editor/editor.main"],(function(MonacoEditorEx){console.log("requirejs resolves",window.monaco,monaco,MonacoEditorEx),MonacoEditorEx.useMonacoEx(window.monaco),resolve(window.monaco)})))}))}}));

//# sourceMappingURL=ui.min.js.map